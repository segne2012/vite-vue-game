import{_ as j}from"./plugin-vue_export-helper.21dcd24c.js";import{d as H,i as y,q as J,x as K,o as t,a as n,b as f,F as A,k as F,n as I,u as _,t as V,l as P,y as Q,z as W,A as X}from"./vendor.1ad6b5c0.js";const O=m=>(Q("data-v-aa1f33dc"),m=m(),W(),m),Y={class:"tetris"},Z={class:"leftView"},$={class:"nextView"},ee={class:"source"},ae={class:"level"},le=O(()=>f("span",null,"\u7B49\u7EA7",-1)),ue=O(()=>f("div",{class:"level"},[f("div",null,"\u7A7A\u683C\uFF1A\u53D8\u5F62"),f("div",null,"\u5DE6\u53F3\uFF1A\u5DE6\u53F3\u79FB\u52A8"),f("div",null,"\xA0\xA0\xA0\u4E0B\uFF1A\u5FEB\u901F\u4E0B\u843D")],-1)),se={class:"mainView"},oe=H({setup(m){let v=y(20),b=y(40),B=y(0),k=y(1),h=y(!1),r=y([]),p=y([]),c=y(g()),a=y(g()),D=!1;function C(){p.value=Array.from({length:4},(u=0,s)=>{let l=s||0;return Array.from({length:4},(i=0,e)=>({x:e||0,y:l,flag:0}))}),r.value=Array.from({length:b.value},(u=0,s)=>{let l=s||0;return Array.from({length:v.value},(i=0,e)=>({x:e||0,y:l,flag:0}))})}function g(u=-1,s=-1){let l=u!=-1?u:Math.floor(Math.random()*6),i=s!=-1?s:Math.floor(Math.random()*4),e={type:l,radius:i,cells:[],cookies:{x:0,y:0},next:()=>{let o;switch(e.type){case 0:o=[[{x:0,y:-2,flag:1},{x:0,y:-1,flag:1},{x:0,y:0,flag:1},{x:0,y:1,flag:1}],[{x:-2,y:0,flag:1},{x:-1,y:0,flag:1},{x:0,y:0,flag:1},{x:1,y:0,flag:1}]],d(o[(e.radius+1)%2])&&e.radius++,e.cells=o[e.radius%2];break;case 1:o=[[{x:-1,y:-1,flag:1},{x:0,y:-1,flag:1},{x:0,y:0,flag:1},{x:0,y:1,flag:1}],[{x:-1,y:1,flag:1},{x:-1,y:0,flag:1},{x:0,y:0,flag:1},{x:1,y:0,flag:1}],[{x:0,y:-1,flag:1},{x:0,y:0,flag:1},{x:0,y:1,flag:1},{x:1,y:1,flag:1}],[{x:-1,y:0,flag:1},{x:0,y:0,flag:1},{x:1,y:0,flag:1},{x:1,y:-1,flag:1}]],d(o[(e.radius+1)%4])&&e.radius++,e.cells=o[e.radius%4];break;case 2:o=[[{x:-1,y:0,flag:1},{x:0,y:-1,flag:1},{x:0,y:0,flag:1},{x:0,y:1,flag:1}],[{x:-1,y:0,flag:1},{x:1,y:0,flag:1},{x:0,y:0,flag:1},{x:0,y:1,flag:1}],[{x:1,y:0,flag:1},{x:0,y:-1,flag:1},{x:0,y:0,flag:1},{x:0,y:1,flag:1}],[{x:-1,y:0,flag:1},{x:0,y:-1,flag:1},{x:0,y:0,flag:1},{x:1,y:0,flag:1}]],d(o[(e.radius+1)%4])&&e.radius++,e.cells=o[e.radius%4];break;case 3:o=[[{x:-1,y:1,flag:1},{x:0,y:-1,flag:1},{x:0,y:0,flag:1},{x:0,y:1,flag:1}],[{x:-1,y:0,flag:1},{x:1,y:0,flag:1},{x:0,y:0,flag:1},{x:1,y:1,flag:1}],[{x:1,y:-1,flag:1},{x:0,y:-1,flag:1},{x:0,y:0,flag:1},{x:0,y:1,flag:1}],[{x:-1,y:-1,flag:1},{x:-1,y:0,flag:1},{x:0,y:0,flag:1},{x:1,y:0,flag:1}]],d(o[(e.radius+1)%4])&&e.radius++,e.cells=o[e.radius%4];break;case 4:o=[[{x:-1,y:0,flag:1},{x:-1,y:-1,flag:1},{x:0,y:0,flag:1},{x:0,y:1,flag:1}],[{x:-1,y:0,flag:1},{x:0,y:-1,flag:1},{x:0,y:0,flag:1},{x:1,y:-1,flag:1}]],d(o[(e.radius+1)%2])&&e.radius++,e.cells=o[e.radius%2];break;case 5:o=[[{x:1,y:0,flag:1},{x:1,y:-1,flag:1},{x:0,y:0,flag:1},{x:0,y:1,flag:1}],[{x:1,y:0,flag:1},{x:0,y:-1,flag:1},{x:0,y:0,flag:1},{x:-1,y:-1,flag:1}]],d(o[(e.radius+1)%2])&&e.radius++,e.cells=o[e.radius%2];break;default:e.cells=[{x:-1,y:0,flag:1},{x:-1,y:-1,flag:1},{x:0,y:0,flag:1},{x:0,y:-1,flag:1}];break}},clearOld:o=>{e.cells.forEach(x=>{o.value&&o.value[x.y+e.cookies.y]&&o.value[x.y+e.cookies.y][x.x+e.cookies.x]&&(o.value[x.y+e.cookies.y][x.x+e.cookies.x].flag=0)})},render:(o,x,E)=>{e.cells.length===0&&(e.radius--,e.next()),e.clearOld(E),e.cookies.x+=o,e.cookies.y+=x,e.cells.forEach(w=>{E.value[w.y+e.cookies.y]&&E.value[w.y+e.cookies.y][w.x+e.cookies.x]&&(E.value[w.y+e.cookies.y][w.x+e.cookies.x].flag=1)})}};return e}function z(){C(),h.value=!1,a.value=g(),a.value.render(v.value/2,0,r),c.value=g(),c.value.render(2,2,p),N()}function L(u){let s=!0;switch(u.key){case"ArrowDown":console.log("\u4E0B"),D=!0;break;case"ArrowLeft":a.value.cells.forEach(l=>{(l.x+a.value.cookies.x-1<0||r.value[l.y+a.value.cookies.y][l.x+a.value.cookies.x-1].flag===2)&&(s=!1)}),s&&a.value.render(-1,0,r);break;case"ArrowRight":a.value.cells.forEach(l=>{(l.x+a.value.cookies.x+1>v.value-1||r.value[l.y+a.value.cookies.y][l.x+a.value.cookies.x+1].flag===2)&&(s=!1)}),s&&a.value.render(1,0,r);break;case" ":console.log("\u7A7A\u683C"),G();break;default:console.log("\u5176\u4ED6");break}}function M(u){switch(u.key){case"ArrowDown":D=!1;break}}function G(){a.value.clearOld(r),a.value.next(),a.value.render(0,0,r)}function d(u=[]){let s=!0;return a.value.cookies.y===0||u.forEach(l=>{(l.x+a.value.cookies.x<=0||l.x+a.value.cookies.x>v.value-1||l.y+a.value.cookies.y>b.value-1||r.value[l.y+a.value.cookies.y][l.x+a.value.cookies.x].flag===2)&&(s=!1)}),s}function T(){a.value.cells.forEach(u=>{u.y+a.value.cookies.y<=0&&(h.value=!0),r.value&&r.value[u.y+a.value.cookies.y]&&r.value[u.y+a.value.cookies.y][u.x+a.value.cookies.x]&&(r.value[u.y+a.value.cookies.y][u.x+a.value.cookies.x].flag=2)}),q(),a.value=g(c.value.type,c.value.radius),a.value.render(v.value/2,0,r),c.value.render(-10,-10,p),X(()=>{c.value=g(),c.value.render(2,2,p)})}function q(){let u=new Set;a.value.cells.forEach(s=>{let l=!0;r.value[s.y+a.value.cookies.y].forEach(i=>{i.flag===0&&(l=!1)}),l&&u.add(s.y+a.value.cookies.y)}),u.size>0&&(B.value+=(2*u.size-1)*10,k.value=Math.floor(B.value/1e3)+1,k.value>12&&(k.value=12)),u.forEach(s=>{for(let l=s;l>0;l--)r.value[l]=r.value[l-1];r.value[0]=new Array(v.value).fill(0).map(()=>({x:0,y:0,flag:0}))})}let U=500,S=0;function N(){new Date().getTime()-S>(D?30:U*Math.pow(.8,k.value-1))&&(S=new Date().getTime(),R()?T():a.value.render(0,1,r)),!h.value&&window.requestAnimationFrame(N)}function R(){let u=!1,s=a.value.cells;for(let l=0;l<s.length;l++){let i=s[l];if(i.y+a.value.cookies.y+1>=b.value)return u=!0,!0;r.value&&r.value[i.y+a.value.cookies.y+1]&&r.value[i.y+a.value.cookies.y+1][i.x+a.value.cookies.x]&&r.value[i.y+a.value.cookies.y+1][i.x+a.value.cookies.x].flag===2&&(u=!0)}return u}return J(()=>{C(),h.value=!0,window.addEventListener("keydown",L),window.addEventListener("keyup",M)}),K(()=>{window.removeEventListener("keydown",L),window.removeEventListener("keyup",M)}),(u,s)=>(t(),n("div",Y,[f("div",Z,[f("div",$,[(t(!0),n(A,null,F(_(p),l=>(t(),n("span",{key:l.toLocaleString(),class:"row"},[(t(!0),n(A,null,F(l,i=>(t(),n("span",{key:i.toString(),class:I(["cell",{active:i.flag===1}])},null,2))),128))]))),128))]),f("div",ee,V(_(B)),1),f("div",ae,[le,f("span",null,V(_(k)),1)]),ue]),f("div",se,[(t(!0),n(A,null,F(_(r),l=>(t(),n("span",{key:l.toString,class:"row"},[(t(!0),n(A,null,F(l,i=>(t(),n("span",{key:i.x+","+i.y,class:I(["cell",{active:i.flag===1,flag:i.flag===2}])},null,2))),128))]))),128))]),_(h)?(t(),n("div",{key:0,class:"gameOver",onClick:z}," \u6E38\u620F\u7ED3\u675F\uFF0C\u70B9\u51FB\u91CD\u65B0\u5F00\u59CB ")):P("",!0)]))}});var fe=j(oe,[["__scopeId","data-v-aa1f33dc"]]);export{fe as default};
